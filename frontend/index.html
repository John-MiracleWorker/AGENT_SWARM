<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Swarm ‚Äî Multi-Agent Coding Platform</title>
    <meta name="description"
        content="A real-time collaborative coding platform where multiple AI agents work together powered by Gemini 3 Pro.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/features.css">
    <link rel="stylesheet" href="/static/css/review.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/css/xterm.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/lib/xterm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0.10.0/lib/addon-fit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@xterm/addon-web-links@0.11.0/lib/addon-web-links.min.js"></script>
</head>

<body>
    <!-- Mission Control Bar (Top) -->
    <header id="mission-control">
        <div class="mc-brand">
            <div class="mc-logo">
                <span class="logo-icon">üêù</span>
                <h1>Agent Swarm</h1>
            </div>
            <div class="mc-badge">Gemini 3 Pro</div>
        </div>

        <div class="mc-mission" id="mission-area">
            <!-- Before mission start -->
            <div class="mc-setup" id="mission-setup">
                <div class="mc-input-group">
                    <button class="btn-folder" id="btn-folder-picker" title="Select workspace folder">
                        üìÅ <span id="folder-label">Select Folder</span>
                    </button>
                    <input type="text" id="goal-input" placeholder="Describe your mission goal..."
                        class="mc-goal-input">
                    <button class="btn-launch" id="btn-launch" disabled>
                        <span class="launch-icon">üöÄ</span> Launch Mission
                    </button>
                </div>
            </div>
            <!-- After mission start -->
            <div class="mc-active hidden" id="mission-active">
                <div class="mc-goal-display">
                    <span class="goal-label">MISSION</span>
                    <span class="goal-text" id="active-goal-text"></span>
                </div>
                <div class="mc-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <span class="progress-text" id="progress-text">0/0 tasks</span>
                </div>
            </div>
        </div>

        <div class="mc-controls" id="mission-controls">
            <div class="mc-token-display" id="token-display">
                <span class="token-label">Tokens</span>
                <span class="token-count" id="token-count">0</span>
                <span class="token-cost" id="token-cost">$0.00</span>
            </div>
            <div class="mc-buttons hidden" id="mission-buttons">
                <button class="btn-control btn-sync" id="btn-git-sync" title="Sync to Git (commit & push)">üîÑ
                    Sync</button>
                <button class="btn-control btn-pause" id="btn-pause" title="Pause">‚è∏Ô∏è</button>
                <button class="btn-control btn-resume hidden" id="btn-resume" title="Resume">‚ñ∂Ô∏è</button>
                <button class="btn-control btn-stop" id="btn-stop" title="Stop">‚èπÔ∏è</button>
            </div>
            <div class="ws-indicator" id="ws-indicator" title="WebSocket disconnected">
                <span class="ws-dot"></span>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main id="main-content">
        <!-- Left Panel: Agent Status -->
        <aside id="agents-panel" class="panel">
            <div class="panel-header">
                <h2>Agents</h2>
                <span class="agent-count" id="agent-count">0</span>
            </div>
            <div class="panel-body" id="agents-list">
                <div class="agents-empty">
                    <p>Launch a mission to deploy agents</p>
                </div>
            </div>
        </aside>

        <!-- Center Panel: Communication Feed -->
        <section id="chat-panel" class="panel">
            <div class="panel-header">
                <h2>Communication Feed</h2>
                <div class="chat-filters">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="chat">Chat</button>
                    <button class="filter-btn" data-filter="code">Code</button>
                    <button class="filter-btn" data-filter="review">Reviews</button>
                </div>
            </div>
            <div class="panel-body" id="chat-messages">
                <div class="chat-welcome">
                    <div class="welcome-icon">üêù</div>
                    <h3>Welcome to Agent Swarm</h3>
                    <p>Select a workspace folder, describe your goal, and launch a mission.<br>Watch as AI agents
                        collaborate to build your project in real-time.</p>
                </div>
            </div>
            <div class="chat-input-area" id="chat-input-area">
                <input type="text" id="user-message-input" placeholder="Send a message to agents..." class="user-input"
                    disabled>
                <button class="btn-send" id="btn-send" disabled>Send</button>
            </div>
        </section>

        <!-- Right Panel: Code Viewer -->
        <aside id="code-panel" class="panel">
            <div class="panel-header">
                <h2>Workspace</h2>
                <div class="tab-group" id="code-tabs">
                    <button class="btn-refresh" id="btn-refresh-files" title="Refresh">üîÑ</button>
                </div>
            </div>
            <div class="panel-body code-panel-body">
                <div class="file-tree" id="file-tree">
                    <div class="tree-empty">No workspace selected</div>
                </div>
                <div class="code-viewer" id="code-viewer">
                    <div class="code-empty">
                        <p>Select a file to view</p>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <!-- Bottom Panel: Terminal + Tasks -->
    <footer id="bottom-panels">
        <div class="bottom-tabs">
            <button class="bottom-tab active" data-panel="terminal-panel">üñ•Ô∏è Terminal</button>
            <button class="bottom-tab" data-panel="tasks-panel">üìã Tasks</button>
            <button class="bottom-tab" data-panel="review-panel">üîç Review</button>
        </div>

        <div class="bottom-content">
            <!-- Terminal Panel -->
            <div class="bottom-panel active" id="terminal-panel">
                <div class="terminal-toolbar">
                    <div class="terminal-tabs" id="terminal-tabs"></div>
                    <div class="terminal-actions">
                        <button class="terminal-btn" id="btn-new-terminal" title="New Terminal">Ôºã</button>
                        <button class="terminal-btn" id="btn-kill-terminal" title="Kill Terminal">‚úï</button>
                        <button class="terminal-btn" id="btn-clear-terminal" title="Clear Terminal">üóëÔ∏è</button>
                    </div>
                </div>
                <div class="terminal-container" id="xterm-container"></div>
            </div>

            <!-- Tasks Panel -->
            <div class="bottom-panel" id="tasks-panel">
                <div class="kanban-board" id="kanban-board">
                    <div class="kanban-column" data-status="todo">
                        <div class="kanban-header">üìù To Do <span class="kanban-count" id="count-todo">0</span></div>
                        <div class="kanban-cards" id="cards-todo"></div>
                    </div>
                    <div class="kanban-column" data-status="in_progress">
                        <div class="kanban-header">üî® In Progress <span class="kanban-count"
                                id="count-in_progress">0</span></div>
                        <div class="kanban-cards" id="cards-in_progress"></div>
                    </div>
                    <div class="kanban-column" data-status="in_review">
                        <div class="kanban-header">üîç In Review <span class="kanban-count" id="count-in_review">0</span>
                        </div>
                        <div class="kanban-cards" id="cards-in_review"></div>
                    </div>
                    <div class="kanban-column" data-status="done">
                        <div class="kanban-header">‚úÖ Done <span class="kanban-count" id="count-done">0</span></div>
                        <div class="kanban-cards" id="cards-done"></div>
                    </div>
                </div>
            </div>

            <!-- Review Panel -->
            <div class="bottom-panel" id="review-panel">
                <div class="review-panel-content">
                    <div class="review-header-bar">
                        <div class="review-status">
                            <span class="review-status-badge pending" id="review-status-badge">‚è≥ Pending</span>
                            <span class="review-cycle-info" id="review-cycle"></span>
                        </div>
                        <div class="review-score" id="review-score">
                            <span class="review-score-value">‚Äî</span>
                            <span class="review-score-label">/100</span>
                        </div>
                    </div>
                    <div class="review-content" id="review-content">
                        <div class="review-empty">
                            <div class="review-empty-icon">üîç</div>
                            <p>Review results will appear here after a mission completes</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Folder Picker Modal -->
    <div class="modal-overlay hidden" id="folder-picker-modal">
        <div class="modal glass-panel">
            <div class="modal-header">
                <h3>üìÅ Select Workspace Folder</h3>
                <button class="modal-close" id="modal-close">‚úï</button>
            </div>
            <div class="modal-path" id="modal-current-path">/</div>
            <div class="modal-body" id="folder-list">
                <div class="loading-spinner"></div>
            </div>
            <div class="modal-footer">
                <button class="btn-select-folder" id="btn-select-folder">Select This Folder</button>
            </div>
        </div>
    </div>

    <!-- Confirm Dialog (replaces browser confirm() to avoid auto-dismiss) -->
    <div class="modal-overlay hidden" id="confirm-modal">
        <div class="modal glass-panel" style="max-width: 400px;">
            <div class="modal-header">
                <h3 id="confirm-modal-title">‚ö†Ô∏è Confirm Action</h3>
            </div>
            <div class="modal-body" style="padding: 16px;">
                <p id="confirm-modal-message" style="color: var(--text-secondary); font-size: 14px; margin: 0;">
                    Are you sure?
                </p>
            </div>
            <div class="modal-footer" style="display: flex; gap: 8px; justify-content: flex-end;">
                <button class="btn-select-folder" id="confirm-cancel"
                    style="background: rgba(255,255,255,0.05); color: var(--text-muted);">Cancel</button>
                <button class="btn-select-folder" id="confirm-ok"
                    style="background: rgba(248,113,113,0.15); color: var(--danger); border-color: rgba(248,113,113,0.3);">
                    Stop Mission</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/static/js/websocket.js"></script>
    <script src="/static/js/agents-panel.js"></script>
    <script src="/static/js/chat-panel.js"></script>
    <script src="/static/js/code-panel.js"></script>
    <script src="/static/js/task-panel.js"></script>
    <script src="/static/js/terminal-panel.js"></script>
    <script src="/static/js/folder-picker.js"></script>
    <script src="/static/js/features-panel.js"></script>
    <script src="/static/js/diff-panel.js"></script>
    <script src="/static/js/review-panel.js"></script>
    <script src="/static/js/app.js"></script>
</body>

</html>